# Предсказание результата маркетинговой компании банка

skillfactory_rds

Python 3.9.7

## Оглавление
[1.Описание проекта](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D0%B0%20%D0%BC%D0%B0%D1%80%D0%BA%D0%B5%D1%82%D0%B8%D0%BD%D0%B3%D0%BE%D0%B2%D0%BE%D0%B9%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8%20%D0%B1%D0%B0%D0%BD%D0%BA%D0%B0#%D0%BE%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0)

[2.Какой кейс решаем?](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D0%B0%20%D0%BC%D0%B0%D1%80%D0%BA%D0%B5%D1%82%D0%B8%D0%BD%D0%B3%D0%BE%D0%B2%D0%BE%D0%B9%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8%20%D0%B1%D0%B0%D0%BD%D0%BA%D0%B0#%D0%BA%D0%B0%D0%BA%D0%BE%D0%B9-%D0%BA%D0%B5%D0%B9%D1%81-%D1%80%D0%B5%D1%88%D0%B0%D0%B5%D0%BC)

[3.Краткая информация о данных](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D0%B0%20%D0%BC%D0%B0%D1%80%D0%BA%D0%B5%D1%82%D0%B8%D0%BD%D0%B3%D0%BE%D0%B2%D0%BE%D0%B9%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8%20%D0%B1%D0%B0%D0%BD%D0%BA%D0%B0#%D0%BA%D1%80%D0%B0%D1%82%D0%BA%D0%B0%D1%8F-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F-%D0%BE-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85)

[4.Этапы работы над проектом](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D0%B0%20%D0%BC%D0%B0%D1%80%D0%BA%D0%B5%D1%82%D0%B8%D0%BD%D0%B3%D0%BE%D0%B2%D0%BE%D0%B9%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8%20%D0%B1%D0%B0%D0%BD%D0%BA%D0%B0#%D1%8D%D1%82%D0%B0%D0%BF%D1%8B-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B-%D0%BD%D0%B0%D0%B4-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%BE%D0%BC) 

[5.Результат](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D0%B0%20%D0%BC%D0%B0%D1%80%D0%BA%D0%B5%D1%82%D0%B8%D0%BD%D0%B3%D0%BE%D0%B2%D0%BE%D0%B9%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8%20%D0%B1%D0%B0%D0%BD%D0%BA%D0%B0#%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82)

[6.Выводы](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D0%B0%20%D0%BC%D0%B0%D1%80%D0%BA%D0%B5%D1%82%D0%B8%D0%BD%D0%B3%D0%BE%D0%B2%D0%BE%D0%B9%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8%20%D0%B1%D0%B0%D0%BD%D0%BA%D0%B0#%D0%B2%D1%8B%D0%B2%D0%BE%D0%B4%D1%8B)


### Описание проекта
Банки хранят огромные объёмы информации о своих клиентах. Эти данные можно использовать для того, чтобы оставаться на связи с клиентами и индивидуально ориентировать их на подходящие именно им продукты или банковские предложения.

Обычно с выбранными клиентами связываются напрямую через разные каналы связи: лично (например, при визите в банк), по телефону, по электронной почте, в мессенджерах и так далее. Этот вид маркетинга называется прямым маркетингом. На самом деле, прямой маркетинг используется для взаимодействия с клиентами в большинстве банков и страховых компаний. Но, разумеется, проведение маркетинговых кампаний и взаимодействие с клиентами — это трудозатратно и дорого.

→ Банкам хотелось бы уметь выбирать среди своих клиентов именно тех, которые с наибольшей вероятностью воспользуются тем или иным предложением, и связываться именно с ними.

У нас имеются данные о последней маркетинговой кампании, которую проводил банк: задачей было привлечь клиентов для открытия депозита. Мы должны проанализировать эти данные, выявить закономерность и найти решающие факторы, повлиявшие на то, что клиент вложил деньги именно в этот банк. 

Когда мы это сделаем, то сможем поднять доходы банка и поможем понять целевую аудиторию, которую необходимо привлекать путём рекламы и различных предложений.

### Какой кейс решаем?

Бизнес-задача: определить характеристики, по которым можно выявить клиентов, более склонных к открытию депозита в банке, и за счёт этого повысить результативность маркетинговой кампании.

Техническая задача для специалиста в Data Science: построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать, воспользуется он предложением об открытии депозита или нет.
 
*Метрика качества*

Для оценки качества модели — точности прогнозов, сделанных моделью, — мы будем использовать метрики F1-мера и accuracy.   
Accuracy (достоверность) — доля правильных ответов модели среди всех ответов. Правильные ответы — это истинно положительные (True Positive) и истинно отрицательные ответы (True Negative)  
F1-мера — это взвешенное среднее гармоническое между precision и recall.  
Даёт обобщённое представление о точности и полноте.  
Максимум достигается, когда максимальны обе метрики, минимум — когда хотя бы одна из метрик равна 0.  

*Что практикуем*

✔️ Исследуйте данные, а не просто вычисляем метрики и создаваем визуализации.  
✔️ Выявляем характерные черты для потенциальных клиентов, чтобы чётко очертить ЦА и увеличить прибыль банка.  
✔️ Проявляем фантазию и используем разные инструменты для повышения качества прогноза.  

### Краткая информация о данных

- Данные о клиентах банка:  
  - age (возраст);  
  - job (сфера занятости);  
  - marital (семейное положение);  
  - education (уровень образования);  
  - default (имеется ли просроченный кредит);  
  - housing (имеется ли кредит на жильё);  
  - loan (имеется ли кредит на личные нужды);  
  - balance (баланс).  
- Данные, связанные с последним контактом в контексте текущей маркетинговой кампании:  
  - contact (тип контакта с клиентом);  
  - month (месяц, в котором был последний контакт);  
  - day (день, в который был последний контакт);  
  - duration (продолжительность контакта в секундах).  
- Прочие признаки:  
  - campaign (количество контактов с этим клиентом в течение текущей кампании);  
  - pdays (количество пропущенных дней с момента последней маркетинговой кампании до контакта в текущей кампании);  
  - previous (количество контактов до текущей кампании)  
  - poutcome (результат прошлой маркетинговой кампании). 

И наша целевая переменная deposit, которая определяет, согласится ли клиент открыть депозит в банке.  
Именно её мы будем пытаться предсказать в данном кейсе.  

### Этапы работы над проектом

*Этапы выполнения проекта:*

1. Первичная обработка данных  
В рамках этой части нам предстоит обработать пропуски и выбросы в данных. Это необходимо для дальнейшей работы с ними.  

2. Разведывательный анализ данных (EDA)  
Вам необходимо будет исследовать данные, нащупать первые закономерности и выдвинуть гипотезы.  

3. Отбор и преобразование признаков  
На этом этапе мв перекодируем и преобразуем данные таким образом, чтобы их можно было использовать при решении задачи классификации. Если на первом этапе мы лишь избавим данные от ненужных артефактов, то на этом шаге совершим действия, более важные для подготовки данных к задаче классификации, уже понимая их структуру.  

4. Решение задачи классификации: логистическая регрессия и решающие деревья  
На данном этапе вы построите свою первую прогностическую модель и оцените её качество. Вы научитесь подбирать оптимальные параметры модели для того, чтобы получить наилучший результат для конкретного алгоритма.  

5. Решение задачи классификации: ансамбли моделей и построение прогноза  
На заключительном этапе вы сможете доработать своё предсказание с использованием более сложных алгоритмов и оценить, с помощью какой модели возможно сделать более качественные прогнозы. 

### Результат

Результаты:

модель логистическая регрессия  
f1-score на тестовом наборе 0.78
accuracy на тестовом наборе 0.80

модель алгоритм решающих деревьев(по умолчанию)  
Train f1_score: 1.00(переобучение)
Test f1_score: 0.72

модель алгоритм решающих деревьев(подбор гиперпараметров по методу GridSearchCV)  
f1_score на тестовом наборе: 0.80
f1_score на тренировочном наборе: 0.82
accuracy на тестовом наборе: 0.81
Переобучения нет, метка f1_score на тестовом наборе улучшилась

модель случайный лес  
f1_score на тестовом наборе: 0.82
accuracy на тестовом наборе: 0.83

модель градиентного бустинга   
f1_score на тестовом наборе: 0.82
accuracy на тестовом наборе: 0.83

модель стекинга  
f1_score на тестовом наборе: 0.82
accuracy на тестовом наборе: 0.83

поиск гиперпараметров с помощью Optuna  
f1_score на тестовом наборе: 0.82
accuracy на тестовом наборе: 0.83

### Выводы
Найдены оптимальные параметры моделей машинного обучения.  
Достигнуты максимальные метрики на тестовом наборе на ряде моделей машинного обучения. 
Наибольшее значение метрик: f1_score 0.82, accuracy 0.83.  
Максимальный вклад в предсказание вносят такие признаки, как длительность разговора по телефону, длительность перерыва между контактами и баланс на счету, чем больше, тем лучше.  


:arrow_up: [к оглавлению](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D0%B0%20%D0%BC%D0%B0%D1%80%D0%BA%D0%B5%D1%82%D0%B8%D0%BD%D0%B3%D0%BE%D0%B2%D0%BE%D0%B9%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8%20%D0%B1%D0%B0%D0%BD%D0%BA%D0%B0#%D0%BE%D0%B3%D0%BB%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5)

