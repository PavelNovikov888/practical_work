# Предсказание категории дохода. Задача классификации.

## Оглавление
[1.Описание проекта](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D0%B0#%D0%BE%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0)

[2.Какой кейс решаем?](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D0%B0#%D0%BA%D0%B0%D0%BA%D0%BE%D0%B9-%D0%BA%D0%B5%D0%B9%D1%81-%D1%80%D0%B5%D1%88%D0%B0%D0%B5%D0%BC)

[3.Краткая информация о данных](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D0%B0#%D0%BA%D1%80%D0%B0%D1%82%D0%BA%D0%B0%D1%8F-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F-%D0%BE-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85)

[4.Этапы работы над проектом](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D0%B0#%D1%8D%D1%82%D0%B0%D0%BF%D1%8B-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B-%D0%BD%D0%B0%D0%B4-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%BE%D0%BC) 

[5.Результат](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D0%B0#%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82)

[6.Выводы](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D0%B0#%D0%B2%D1%8B%D0%B2%D0%BE%D0%B4%D1%8B)


### Описание проекта
Целью данной задачи является построение модели **классификации пользователей**

### Какой кейс решаем?

Бизнес-задача: Построить модель по которой можно выявить клиентов с большим доходом и за счёт этого повысить результативность маркетинговой кампании.

Техническая задача для специалиста в Data Science: построить модель машинного обучения, которая  на вход  будет принимать данные о человеке, а на выходе она должна предсказывать бинарный уровень дохода человека (больше или меньше 50000$ за год) и определить способ кодирования признаков при котором выбранные метрики получаются оптимальными.

*Метрика качества*

Для оценки качества модели — точности прогнозов, сделанных моделью, — мы будем использовать метрику accuracy.   
Accuracy (достоверность) — доля правильных ответов модели среди всех ответов. Правильные ответы — это истинно положительные (True Positive) и истинно отрицательные ответы (True Negative)  

Также мы спрогнозируем вероятность принадлежности к классу и на основе этого вычислим метрику как площадь по графиком ROC  
Одной из самых популярных метрик для задачи классификации является ROC кривая.  
 ROC расшифровывается как *Receiver Operating Characteristic*.   
 Эта кривая наглядно показывает зависимость доли истинно позитивных срабатываний (**TPR**) от доли ложно позитивных срабатываний (**FPR**) при изменении порога классификации.  
Чем больше площадь под этим графиком, тем лучше набор данных выбранный для построения модели.    
В нашем случае это OneHotEncoding или LabelEncoding. 

*Что практикуем*

✔️ Кодирование данных методами OneHotEncoding или LabelEncoding  
✔️ Построение модели логистической регресии   
✔️ Вычисление прогноза вероятности принадлежности к классу  
✔️ Построение ROC кривой   
✔️ Логгирование с использованием платформы Comet ML  

### Краткая информация о данных

- Данные можно скачать по ссылкам  
https://www.dropbox.com/s/1hfrcm09qtvoeoz/train.csv  
https://www.dropbox.com/s/jj7c8r0x57zda0a/test.csv  
или использовать файлы, лежащие в репозитории. 
 

### Этапы работы над проектом

*Этапы выполнения проекта:*

1. Постановка задачи.
2. Загрузка библиотек и платформы Comet для логгирования.
3. Загрузка данных.
4. Оценка сбалансированности выборк
5. Предобработка данных(пропуски, выбросы)
6. Кодировка категориальных признаков методами OneHotEncoding и LabelEncoding. Создание 2х разных тренинговых датасетов
7. Обучение моделей классификации на разных типах закодированных данных
8. Валидация моделей на тестовых выборках
9. Расчет метрики accuracy для обоих моделей.
10. Расчет прогнозов вероятности принадлежности к к классам
11. Построение ROC кривых моделей
12. Вычисление метрики площади под ROC кривой

### Результат

Метрики:  
Accuracy LabelEncoding data = 0.804  
Accuracy OneHotEncoder data = 0.857  

ROC-AUC на тестовой выборке OneHotEncoding: 0.904  
ROC-AUC на тестовой выборке LabelEncoding: 0.813  

### Выводы
Лучшие результаты показывает датасет с кодировкой OneHotEncoding


:arrow_up: [к оглавлению](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9F%D1%80%D0%B5%D0%B4%D1%81%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D0%B0#%D0%BE%D0%B3%D0%BB%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5)

