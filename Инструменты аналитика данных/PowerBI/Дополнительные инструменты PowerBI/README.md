# Оптимизация_гиперпараметров

skillfactory_rds

Python 3.9.7

## Оглавление

[1.Описание задачи](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9E%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F_%D0%B3%D0%B8%D0%BF%D0%B5%D1%80%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2#%D0%BE%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0)

[2.Какой кейс решаем?](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9E%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F_%D0%B3%D0%B8%D0%BF%D0%B5%D1%80%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2#%D0%BA%D0%B0%D0%BA%D0%BE%D0%B9-%D0%BA%D0%B5%D0%B9%D1%81-%D1%80%D0%B5%D1%88%D0%B0%D0%B5%D0%BC)

[3.Краткая информация о данных](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9E%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F_%D0%B3%D0%B8%D0%BF%D0%B5%D1%80%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2#%D0%BA%D1%80%D0%B0%D1%82%D0%BA%D0%B0%D1%8F-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F-%D0%BE-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85)

[4.Этапы работы над проектом](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9E%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F_%D0%B3%D0%B8%D0%BF%D0%B5%D1%80%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2#%D1%8D%D1%82%D0%B0%D0%BF%D1%8B-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B-%D0%BD%D0%B0%D0%B4-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%BE%D0%BC) 

[5.Результат](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9E%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F_%D0%B3%D0%B8%D0%BF%D0%B5%D1%80%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2#%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82)

[6.Выводы](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9E%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F_%D0%B3%D0%B8%D0%BF%D0%B5%D1%80%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2#%D0%B2%D1%8B%D0%B2%D0%BE%D0%B4%D1%8B)


### Описание задачи

Необходимо предсказать биологический ответ молекул (столбец 'Activity') по их химическому составу (столбцы D1-D1776).


### Какой кейс решаем?

Необходимо обучить две модели: логистическую регрессию и случайный лес. Далее нужно сделать подбор гиперпараметров с помощью базовых и продвинутых методов оптимизации. Важно использовать все четыре метода (GridSeachCV, RandomizedSearchCV, Hyperopt, Optuna) хотя бы по разу, максимальное количество итераций не должно превышать 50.

*Метрика качества*

В качестве метрики будем использовать F1-score.

*Что практикуем*

Учимся использовать различные методы оптимизации гиперпараметров.

### Краткая информация о данных

Данные представлены в формате CSV. Каждая строка представляет молекулу.

Первый столбец Activity содержит экспериментальные данные, описывающие фактический биологический ответ [0, 1];

Остальные столбцы D1-D1776 представляют собой молекулярные дескрипторы — это вычисляемые свойства, которые могут фиксировать некоторые характеристики молекулы, например размер, форму или состав элементов.

Предварительная обработка не требуется, данные уже закодированы и нормализованы.

### Этапы работы над проектом
Проведены обучение моделей Логистической регресссии и Случайного леса
с использованием 4 методов оптимизации гиперпараметров GridSearchCV, RandomizedSearchCV, Optuna, Hyperopt

### Результат

Получены следующие результаты:

Default Логистическая регрессия

    * Гиперпараметры: установленные по умолчанию.
    * f1_score на тестовом наборе: 0.78
    
GridSearchCV Логистическая регрессия

    * f1_score на тестовом наборе: 0.78
    * Наилучшие значения гиперпараметров: {'C': 0.3, 'penalty': 'l1', 'solver': 'saga'}
GridSearchCV Логистическая регрессия

    * f1_score на тестовом наборе: 0.78
    * Наилучшие значения гиперпараметров: {'penalty': 'l1', 'solver': 'liblinear'}
RandomizedSearchCV Логистическая регрессия

    * f1_score на тестовом наборе: 0.79
    * Наилучшие значения гиперпараметров: {'C': 0.01, 'penalty': 'l2', 'solver': 'sag'}
Default Случайный лес

    * f1_score на обучающем наборе: 1.00
    * f1_score на тестовом наборе: 0.82
RandomizedSearchCV Случайный лес

    * f1_score на обучающем наборе: 0.94
    * f1_score на тестовом наборе: 0.82
    * Наилучшие значения гиперпараметров: {'n_estimators': 140, 'min_samples_leaf': 5, 'max_depth': 28}
GridSearchCV Случайный лес

    * f1_score на обучающем наборе: 0.94
    * f1_score на тестовом наборе: 0.82
    * Наилучшие значения гиперпараметров: {'max_depth': 30, 'min_samples_leaf': 5, 'n_estimators': 140}
Hyperopt Случайный лес

    * f1_score на обучающем наборе: 0.99
    * f1_score на тестовом наборе: 0.82
Hyperopt Логистическая регрессия

    * Наилучшие значения гиперпараметров {'C': 1.0, 'penalty': 'none', 'solver': 'lbfgs'}
    * f1_score на обучающем наборе: 0.93
    * f1_score на тестовом наборе: 0.77
Optuna Случайный лес

    * Наилучшие значения гиперпараметров {'n_estimators': 200, 'max_depth': 30, 'min_samples_leaf': 2}
    * f1_score на обучающем наборе: 0.99
    * f1_score на тестовом наборе: 0.83
Optuna Логистическая регрессия

    * Наилучшие значения гиперпараметров {'penalty': 'none', 'solver': 'lbfgs', 'C': 0.01}
    * f1_score на обучающем наборе: 0.90
    * f1_score на тестовом наборе: 0.77

### Выводы

Максимальные значения метрики f1-score = 83 достигнуты с помощью комбинации методов Optuna и Случайный лес за достаточно быстрое время 1m3s

:arrow_up: [к оглавлению](https://github.com/PavelNovikov888/practical_work/tree/master/%D0%9E%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F_%D0%B3%D0%B8%D0%BF%D0%B5%D1%80%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2#%D0%BE%D0%B3%D0%BB%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5)
